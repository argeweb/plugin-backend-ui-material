function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function is_aside(){return"aside_iframe"==window.name}function is_content(){return"content_iframe"==window.name}function reload(){is_aside()?backend.aside_iframe.reload():backend.content_iframe.reload()}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function addClass(a){$("body").addClass(a)}function removeClass(a){$("body").removeClass(a)}function changeView(){$("body").removeClass("in-"+backend.view.last+"-mode").addClass("in-"+backend.view.current+"-mode"),"function"==typeof page["change_view_to_"+backend.view.current]&&page["change_view_to_"+backend.view.current]()}function changeViewAndReload(){backend.view.last!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.content_iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if(is_aside()&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),is_content()&&$("header").hide()),$(".aside-close").click(function(){backend.aside_iframe.closeUi()}),is_content()&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){is_content()&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside_iframe.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.content_iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text();$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){console.log("aaaa"),makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback&&"undefined"!==callback?eval(callback+"("+JSON.stringify(data)+")"):is_content()&&backend.content_iframe.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside_iframe.load($(this).attr("href")):backend.content_iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked");$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action);
}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup;
}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_material/static/plugins/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen"),$(".page-header").toggle()}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function showTimeout(a){hideHeader('<div style="margin: 100px auto; width: 40%; font-size: 18px;">連線逾時</div>',a)}function showLoading(a){hideHeader('<div id="onLoad"><div class="sk-spinner sk-spinner-chasing-dots"><div class="sk-dot1"></div><div class="sk-dot2"></div></div></div>',a)}function hideHeader(a,b){$(".page-header").stop().animate({top:-70}),0==$("header").length&&"function"==typeof b?b():$("header").stop().animate({top:-70},250,function(){$("body").addClass("body-hide").html(a),"function"==typeof b&&b()})}function changeView(){var a=backend.view.current;$("body").removeClass("in-view-mode").removeClass("in-edit-mode").removeClass("in-delete-mode").removeClass("in-sort-mode").addClass("in-"+a+"-mode")}function changeViewAndReload(){currentView!=backend.view.current&&(currentView=backend.view.current,"edit"!=currentView&&"view"!=currentView||$("a."+currentView+"-url").first().click())}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function setBodyClass(a){$("body").addClass(a)}function pageInit(a){if(page={},a)try{$("body").html(a)}catch(a){console.log(a)}var b=-70,c=0,d=0;if("aside_iframe"==window.name&&(b=0,c=56,d=56,$("body").addClass("aside")),$(".page-header").stop().animate({top:b},300),""!=$("header").text().trim()?(d+=0,$("body").addClass("has-header"),$("header").stop().animate({top:c},300)):($("body").addClass("no-header"),"content_iframe"==window.name&&$("header").hide()),$(".aside-close").click(function(){backend.aside.closeUi()}),"content_iframe"==window.name&&(d=0),$(".scrollDiv").stop().animate({"margin-top":d},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}).css({height:"calc(100% - "+d+"px)"}).scroll(function(){"content_iframe"==window.name&&backend.affix($(this).scrollTop())}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),checkNavItemAndShow();try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",data:"資料已更新",config:"設定已變更",undefined:"未定義的訊息"},e=d[a.response_method];"undefined"==typeof e&&(e=d.undefined),"success"==a.response_info?(save_with_exit?(save_with_exit=!1,setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(e)):show_message(e,1800),backend.ui.setUserInformation($("#name").val(),$("#avatar").val()),"add"!=a.response_method&&"edit"!=a.response_method||backend.iframe.reload(!0)):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".filepicker").click(function(){start_filepicker($(this).parents(".input-group").find("input"),!1)}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden"),$(".fixed-table-loading").hide()}).bootstrapTable(),setTimeout(function(){$(".fbtn-container").fadeIn()},800)}}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("gallery-item"))return void e.preventDefault();if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"==$(this).attr("target")?backend.aside.load($(this).attr("href")):backend.iframe.load($(this).attr("href"),t,location.pathname),e.preventDefault(),e.stopPropagation()}})}function makeSortTable(){$("table").stickyTableHeaders({scrollableArea:$(".scrollDiv")});try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}function json(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:!1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function json_async(a,b,c,d){$.ajax({url:a,type:"POST",dataType:"json",cache:!1,data:b,async:1,success:function(a){c(a)},error:function(a,b,c){void 0==d?show_message(a.responseJSON.error):d(a.responseJSON)}})}function ajax_post(a,b,c,d){$.ajax({url:a,type:"POST",cache:!0,data:b,async:!0,success:function(a){c(a)},error:function(a,b,c){d?d(a.responseText):window.alert(c.message)}})}function getRandID(a){void 0==a&&(a="rand-id-");for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function showBackToListButton(){$(".backToList").show()}function show_message(a,b){backend.message.quick_show(a,b)}function parent_is_ready(){show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup}function change_lang(a){$("a.btn-lang").eq(a).click()}function create_editor(a){var b=tinyMCE.createEditor(a,{theme:"modern",content_css:["/plugins/backend_ui_fuscata/static/TinyMCE/4.2.5/skins/lightgray/content.min.css"],height:400,plugins:["link image media code table preview hr anchor pagebreak textcolor fullscreen colorpicker "],toolbar:"undo redo | styleselect | alignleft aligncenter alignright forecolor backcolor bold italic | link upload_image image media | code custom_fullscreen",statusbar:!1,menubar:!1,setup:function(a){"undefined"!=typeof filepicker&&a.addButton("upload_image",{title:"插入圖片",image:"/plugins/backend_ui_fuscata/static/TinyMCE/4.2.5/themes/upload_image.png",onclick:function(){var b=a;start_filepicker(b,!0)}}),a.addButton("custom_fullscreen",{title:"擴大編輯區",image:"/plugins/backend_ui_fuscata/static/TinyMCE/4.2.5/themes/fullscreen.png",onclick:function(){a.execCommand("mceFullScreen")}}),a.on("init",function(a){})},convert_urls:!1,relative_urls:!1,remove_script_host:!1});b.render()}function save_form(){if($("form").length<=0)return!1;if(1==is_saving)return!1;console.log(is_saving),is_saving=!0,clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},5e3);var a=$("form");a.find(".field-type-rich-text-field").each(function(){var a=$(this).attr("id");tinyMCE.get(a)&&$(this).val(tinyMCE.get(a).getContent()),$(this).change()}),a.submit()}function save_and_exit(){save_with_exit=!0,save_form()}function scrollDiv(){$(".scrollDiv").addClass("on"),backend.iframe.removeMask()}function checkNavItemAndShow(){$("a.btn-lang").first().click(),$(".list-operations").each(function(){$(this).find("li").length>0?$(this).removeClass("hide"):$(this).addClass("hide")}),$(".nav-box li").length>0&&$(".nav-box").removeClass("hide").addClass("animated").addClass("fadeInUp")}function linkClickProcess(){$("body").on("click","a",function(e){var _url=$(this).attr("href");if(void 0===_url)return void e.preventDefault();if($(this).hasClass("btn-lang")){e.preventDefault();var lang=$(this).data("lang");return $("div.lang").hide(),void $("div.lang.lang-"+lang).show()}if($(this).hasClass("btn-json-delete"))return e.preventDefault(),e.stopPropagation(),void backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0,closeOnConfirm:!1},function(){json(_url,null,function(a){swal("删除成功！","您已经永久删除了此記錄。","success"),location.reload()},function(a){swal("删除失敗！","刪除記錄時發生問題。","error")})});if($(this).hasClass("btn-json")){e.preventDefault();var callback=$(this).data("callback");return void json(_url,null,function(data){void 0!==callback?eval(callback+"("+JSON.stringify(data)+")"):location.reload()},function(a){show_message("404"==a.code?"找不到目標頁面":a.error)})}if(_url.indexOf("javascript:")<0&&_url.indexOf("#")<0){var i_text=$(this).find(".icon").text()?$(this).find(".icon").length>0:"",t=$(this).text().replace(i_text,"").trim();"aside_iframe"!=$(this).attr("target")?backend.iframe.load($(this).attr("href"),t,location.pathname):backend.aside.load($(this).attr("href"))}})}function makeSortTable(){try{$(".sortable-list tbody").sortable({placeholder:"ui-state-highlight",handle:"td.move-headline",opacity:.8,cursor:"move",axis:"y",update:function(){var a="",b=$(".sortable-list tbody");b.find("tr").each(function(){void 0!=$(this).data("id")&&(a+="rec[]="+$(this).data("id")+"&")}),json_async("/admin/record/sort.json",a+b.sortable("serialize"),function(a){backend.message.snackbar("排序完成...")},function(a){return!1})}})}catch(a){}}function makeListOp(){return 1!=$(".filed-display-operations ul").data("done")&&($("input[data-field]").each(function(){var a=$(this).data("field"),b=($(this).text(),$(this).val()),c=$(this).attr("checked");"is_enable"!=a&&"record_buttons"!=a&&""!=a&&$(".filed-display-operations ul").append('<li><input type="checkbox" '+c+' id="ro-field-'+a+'" value="'+b+'"><label for="ro-field-'+a+'">'+$(this).parent().text()+"</label></li>")}),$(".filed-display-operations ul input[type=checkbox]").change(function(){var a=$(this).attr("id").replace("ro-field-","");$(this).is(":checked"),$("input[data-field='"+a+"']").click()}),void $(".filed-display-operations ul").attr("data-done",!0))}var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),is_aside()?(backend.aside_iframe.init("#aside_iframe"),backend.aside_iframe.page=page):(backend.content_iframe.init("#content_iframe"),backend.content_iframe.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside_iframe.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.content_iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),
"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,dom_is_ready=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,page={},start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length?$("#dropping").addClass("no_target"):($("#dropping").removeClass("no_target"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box"))},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target;console.log(d);var e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=a.response.item.__key__,d=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));d.find("input").first().val(a.response.url).data("key",c).show(),""==b?d.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):(d.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none"),d.find("input").first().change())},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}},currentView="edit";$(function(){""!=window.name&&pageInit(),linkClickProcess(),"content_iframe"==window.name&&(backend.iframe.init("#content_iframe"),backend.iframe.page=page),"aside_iframe"==window.name&&(backend.aside.init("#aside_iframe"),backend.aside.page=page),$(document).on("click",function(a){backend.ui.closeSearchBox(),backend.ui.closeMessageBox()}).on("click",".record_item td",function(a){if(!(a.target.outerHTML.indexOf("switch-toggle")>0||a.target.outerHTML.indexOf("input")>0)){currentView=backend.view.current;var b=currentView+"-url",c=$(this).parent().data(b);$(this).hasClass("record_item")&&(c=$(this).data(b)),c&&""!=c&&(console.log(currentView),"delete"!=currentView?backend.aside.load(c):backend.swal({title:"您確定要刪除此記錄嗎",text:"删除後后将無法恢複，請谨慎操作！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",showLoaderOnConfirm:!0}).then(function(){json(c,null,function(a){backend.swal("删除成功！","您已经永久删除了此記錄。","success"),backend.iframe.reload()},function(a){backend.swal("删除失敗！","刪除記錄時發生問題。","error")})}))}}).on("change",".file_picker_div input",function(){var a=$(this).val();$(this).parents(".file_picker_div").hasClass("image")?$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"):(console.log(a.split(".")[1]),$(this).parents(".file_picker_div").find(".file_picker_item").attr("data-ext",a.split(".")[1]).text(a.split(".")[1])),"avatar"==$(this).attr("id")&&backend.ui.setUserInformation($("#name").val(),a)}).on("change",".record_item td .btn-checkbox-json",function(){if($(this).is(":checked")){var a=$(this).data("enable-text");json($(this).data("enable-url"),null,function(b){"success"==b.info&&backend.message.snackbar(a+"...")})}else{var b=$(this).data("disable-text");json($(this).data("disable-url"),null,function(a){"success"==a.info&&backend.message.snackbar(b+"...")})}}),key.filter=function(a){var b=(a.target||a.srcElement).tagName;return key.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(b)?"input":"doc"),!0},key(backend.shortcut.keys,"doc",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),key(backend.shortcut.keys,"input",function(a,b){return backend.shortcut.catchEvent(window.name,b.shortcut,b.scope)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()}});var save_with_exit=!1,is_saving=!1,timeout_lock_saving=null,backend=parent,backToList=backend.iframe.backToList,start_filepicker=backend.uploader.pickup;backend.js_is_ready&&1==backend.js_is_ready&&(show_message=backend.message.quick_show,start_filepicker=backend.uploader.pickup);var pageDOD={visual_timer:3,init:function(){0==$(".file_picker_div, .imgs_selector_div, .field-type-rich-text-field").length&&$("#dropping").addClass("no_target")},onDragStart:function(a){a.preventDefault(),a.stopPropagation(),$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},onDragEnd:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=0,setTimeout(pageDOD.removeVisualClass,1e3)},onDragOver:function(a){a.preventDefault(),a.stopPropagation(),pageDOD.visual_timer=3,$("html").addClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().addClass("dropping-box")},removeVisualClass:function(){0==pageDOD.visual_timer?($("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),pageDOD.visual_timer=0):(pageDOD.visual_timer--,setTimeout(pageDOD.removeVisualClass,1e3))},onDrop:function(a){var b=a.dataTransfer.files;if(a.preventDefault(),pageDOD.visual_timer=0,$("html").removeClass("dropping"),$(".file_picker_div, .imgs_selector_div").parent().parent().removeClass("dropping-box"),b.length>10)return void backend.message.insert("danger","錯誤","一次可上傳 10個文件",void 0);for(var c=0;c<b.length;c++){var d=a.target,e=getRandID("upload-");$(d).hasClass("form-group")?$(d).attr("data-uploadId",e):$(d).parents(".form-group").attr("data-uploadId",e),$(d).hasClass("mce-content-body")||$(d).parents("body").hasClass("mce-content-body ")?(e=$(d).parents("body").data("id")||$(d).data("id"),backend.uploader.addFile(b[c],e,pageDOD.setEditorValue)):backend.uploader.addFile(b[c],e,pageDOD.setTargetValue)}},setTargetValue:function(a){var b=a.response.url,c=(a.target_id,$("*[data-uploadId='"+a.target_id+"']"));c.find("input").first().val(a.response.url).show(),""==b?c.find(".file_picker_item").css("background-image","none").addClass("file_picker_item_none"):c.find(".file_picker_item").css("background-image","url("+b+")").removeClass("file_picker_item_none")},setEditorValue:function(a){var b=a.response.url,c=a.target_id;tinyMCE.get(c)&&tinyMCE.get(c).selection.setContent('<img src="'+b+'" />')}};$(function(){var a=-70,b=0,c=0;if("aside_iframe"==window.name&&(a=0,b=56,c=60,$("body").addClass("aside")),$(".page-header").stop().animate({top:a},300),""!=$("header").text().trim()?(c+=60,$("body").addClass("has-header"),$("header").stop().animate({top:b},300),a>=0&&backend.affix(100)):$("body").addClass("no-header"),$(".aside-close").click(function(){backend.aside.closeUi()}),$(".scrollDiv").stop().animate({"margin-top":c},300).hover(function(){scrollDiv()},function(){$(this).removeClass("on")}).mouseover(function(){scrollDiv()}).mouseleave(function(){$(this).removeClass("on")}),window!=top){$("#onLoad").remove(),$("body").removeClass("body-hide"),$(document).on("click",function(a){backend.close_msg_nav()}).on("click",".record_item, .record_item",function(){var a=$(this).parent().data("view-url");$(this).hasClass("record_item")&&(a=$(this).data("view-url")),a&&""!=a&&backend.aside.load(a)}).on("keydown",function(a){backend.short_key(window.name,a)}),pageDOD.init(),linkClickProcess(),checkNavItemAndShow(),$(".enter-sorting-mode").click(function(){$("body").toggleClass("in-sort-mode","")}),$("#list-table").on("post-body.bs.table",function(){makeSortTable(),makeListOp(),checkNavItemAndShow(),$(".sortable-list").removeClass("hidden")});try{$("iframe[name='iframeForm']").load(function(){var a=JSON.parse($(this).contents().find("body").text());$(".form-group").removeClass("has-error has-danger").find(".help-block").text("");var b=a.errors;if(b){for(var c in b)$("form #"+c).parents(".form-group").addClass("has-error has-danger").find(".help-block").text(b[c]);$("form").attr("action").indexOf("/_ah/upload/")>=0&&$("form").attr("action",a.new_form_action)}var d={add:"記錄已新增",edit:"記錄已儲存",profile:"資料已更新",undefined:"未定義的訊息"};"success"==a.response_info?save_with_exit?(setTimeout(backend.aside.closeUi(),10),backend.message.snackbar(d[a.response_method])):show_message(d[a.response_method],1800):backend.message.snackbar("表單欄位有誤"),clearTimeout(timeout_lock_saving),timeout_lock_saving=setTimeout(function(){is_saving=!1},3e3)}),$(".submit_and_exit").click(function(){save_with_exit=!0,save_form()})}catch(a){}$(".file_picker_div input").on("change",function(){var a=$(this).val();$(this).parents(".file_picker_div").find(".file_picker_item").css("background-image","url("+a+")"),"avatar"==$(this).attr("id")&&backend.set_avatar(location.href,a)}),$(".filepicker").click(function(){start_filepicker($(this).parents(".file_picker_div").find("input"))}),tinyMCE.editors=[],$(".field-type-rich-text-field").each(function(){$(this).prev().text(),$(this).prev().remove();var a=$(this).attr("id");void 0==a&&(a=$(this).attr("name"),$(this).attr("id",a)),a&&create_editor(a)}),window.onbeforeunload=function(){$(document).unbind(),$(document).find("*").unbind()},setTimeout(function(){$(".fbtn-container").fadeIn()},1e3)}});
//# sourceMappingURL=page.min.js.map