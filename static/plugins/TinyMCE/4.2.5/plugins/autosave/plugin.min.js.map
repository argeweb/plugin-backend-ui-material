{"version":3,"sources":["plugin.min.js"],"names":["tinymce","_beforeUnloadHandler","a","each","editors","b","plugins","autosave","storeDraft","isDirty","getParam","translate","PluginManager","add","c","s","m","exec","parseInt","n","getItem","k","Date","getTime","autosave_retention","d","removeItem","fire","e","j","setItem","getContent","format","no_events","f","setContent","g","l","setInterval","removed","autosave_interval","h","this","disabled","on","i","undoManager","beforeChange","settings","forced_root_block","trim","getBody","innerHTML","RegExp","test","util","LocalStorage","autosave_prefix","replace","document","location","pathname","search","id","addButton","title","onclick","onPostRender","addMenuItem","text","context","autosave_restore_when_empty","window","onbeforeunload","hasDraft","restoreDraft","removeDraft","isEmpty"],"mappings":"AAAAA,QAAQC,qBAAqB,WAAW,GAAIC,EAAE,OAAOF,SAAQG,KAAKH,QAAQI,QAAQ,SAASC,GAAGA,EAAEC,QAAQC,UAAUF,EAAEC,QAAQC,SAASC,cAAcN,GAAGG,EAAEI,WAAWJ,EAAEK,SAAS,8BAA6B,KAAMR,EAAEG,EAAEM,UAAU,uEAAuET,GAAGF,QAAQY,cAAcC,IAAI,WAAW,SAASX,GAAG,QAASG,GAAEH,EAAEG,GAAG,GAAIS,IAAGC,EAAE,IAAIC,EAAE,IAAK,OAAOd,GAAE,iBAAiBe,KAAK,IAAIf,GAAGG,KAAKH,EAAE,GAAGY,EAAEZ,EAAE,IAAI,GAAGgB,SAAShB,EAAE,IAAI,QAASY,KAAI,GAAIZ,GAAEgB,SAASC,EAAEC,QAAQC,EAAE,QAAQ,KAAK,CAAE,UAAQ,GAAKC,OAAMC,UAAUrB,EAAEc,EAAEQ,qBAAqBC,GAAE,GAAI,IAAI,QAASA,GAAEpB,GAAGc,EAAEO,WAAWL,EAAE,SAASF,EAAEO,WAAWL,EAAE,QAAQhB,KAAI,GAAIH,EAAEyB,KAAK,eAAe,QAASC,MAAKC,KAAK3B,EAAEO,YAAYU,EAAEW,QAAQT,EAAE,QAAQnB,EAAE6B,YAAYC,OAAO,MAAMC,WAAU,KAAMd,EAAEW,QAAQT,EAAE,QAAO,GAAKC,OAAMC,WAAWrB,EAAEyB,KAAK,eAAe,QAASO,KAAIpB,MAAMZ,EAAEiC,WAAWhB,EAAEC,QAAQC,EAAE,UAAUW,OAAO,QAAQ9B,EAAEyB,KAAK,iBAAiB,QAASS,KAAIC,IAAIC,YAAY,WAAWpC,EAAEqC,SAASX,KAAKZ,EAAEwB,mBAAmBH,GAAE,GAAI,QAASI,KAAI,GAAIpC,GAAEqC,IAAKrC,GAAEsC,UAAU7B,KAAKZ,EAAE0C,GAAG,sCAAsC,WAAWvC,EAAEsC,UAAU7B,OAAOsB,IAAI,QAASS,KAAI3C,EAAE4C,YAAYC,eAAeb,IAAIT,IAAIvB,EAAE4C,YAAYjC,MAAM,QAASgB,GAAExB,GAAG,GAAIS,GAAEZ,EAAE8C,SAASC,iBAAkB,OAAO5C,GAAEL,QAAQkD,KAAK,mBAAoB7C,GAAEH,EAAEiD,UAAUC,UAAU/C,GAAG,KAAKA,GAAG,GAAIgD,QAAO,KAAKvC,EAAE,0CAA0CA,EAAE,UAAU,KAAKwC,KAAKjD,GAAG,GAAIgB,GAAEgB,EAAErB,EAAEd,EAAE8C,SAAS7B,EAAEnB,QAAQuD,KAAKC,YAAanC,GAAEL,EAAEyC,iBAAiB,uCAAuCpC,EAAEA,EAAEqC,QAAQ,YAAYC,SAASC,SAASC,UAAUxC,EAAEA,EAAEqC,QAAQ,aAAaC,SAASC,SAASE,QAAQzC,EAAEA,EAAEqC,QAAQ,UAAUxD,EAAE6D,IAAI/C,EAAEwB,kBAAkBnC,EAAEW,EAAEwB,kBAAkB,OAAOxB,EAAEQ,mBAAmBnB,EAAEW,EAAEQ,mBAAmB,OAAOtB,EAAE8D,UAAU,gBAAgBC,MAAM,qBAAqBC,QAAQrB,EAAEsB,aAAa1B,IAAIvC,EAAEkE,YAAY,gBAAgBC,KAAK,qBAAqBH,QAAQrB,EAAEsB,aAAa1B,EAAE6B,QAAQ,SAASpE,EAAE8C,SAASuB,+BAA8B,IAAKrE,EAAE0C,GAAG,OAAO,WAAW9B,KAAKe,KAAKK,MAAMhC,EAAE0C,GAAG,cAAc,WAAWnB,OAAO+C,OAAOC,eAAezE,QAAQC,qBAAqByC,KAAKgC,SAAS5D,EAAE4B,KAAKlC,WAAWoB,EAAEc,KAAKiC,aAAazC,EAAEQ,KAAKkC,YAAYnD,EAAEiB,KAAKmC,QAAQhD","file":"plugin.min.js","sourcesContent":["tinymce._beforeUnloadHandler=function(){var a;return tinymce.each(tinymce.editors,function(b){b.plugins.autosave&&b.plugins.autosave.storeDraft(),!a&&b.isDirty()&&b.getParam(\"autosave_ask_before_unload\",!0)&&(a=b.translate(\"You have unsaved changes are you sure you want to navigate away?\"))}),a},tinymce.PluginManager.add(\"autosave\",function(a){function b(a,b){var c={s:1e3,m:6e4};return a=/^(\\d+)([ms]?)$/.exec(\"\"+(a||b)),(a[2]?c[a[2]]:1)*parseInt(a,10)}function c(){var a=parseInt(n.getItem(k+\"time\"),10)||0;return!((new Date).getTime()-a>m.autosave_retention&&(d(!1),1))}function d(b){n.removeItem(k+\"draft\"),n.removeItem(k+\"time\"),b!==!1&&a.fire(\"RemoveDraft\")}function e(){!j()&&a.isDirty()&&(n.setItem(k+\"draft\",a.getContent({format:\"raw\",no_events:!0})),n.setItem(k+\"time\",(new Date).getTime()),a.fire(\"StoreDraft\"))}function f(){c()&&(a.setContent(n.getItem(k+\"draft\"),{format:\"raw\"}),a.fire(\"RestoreDraft\"))}function g(){l||(setInterval(function(){a.removed||e()},m.autosave_interval),l=!0)}function h(){var b=this;b.disabled(!c()),a.on(\"StoreDraft RestoreDraft RemoveDraft\",function(){b.disabled(!c())}),g()}function i(){a.undoManager.beforeChange(),f(),d(),a.undoManager.add()}function j(b){var c=a.settings.forced_root_block;return b=tinymce.trim(\"undefined\"==typeof b?a.getBody().innerHTML:b),\"\"===b||new RegExp(\"^<\"+c+\"[^>]*>((Â |&nbsp;|[ \\t]|<br[^>]*>)+?|)</\"+c+\">|<br>$\",\"i\").test(b)}var k,l,m=a.settings,n=tinymce.util.LocalStorage;k=m.autosave_prefix||\"tinymce-autosave-{path}{query}-{id}-\",k=k.replace(/\\{path\\}/g,document.location.pathname),k=k.replace(/\\{query\\}/g,document.location.search),k=k.replace(/\\{id\\}/g,a.id),m.autosave_interval=b(m.autosave_interval,\"30s\"),m.autosave_retention=b(m.autosave_retention,\"20m\"),a.addButton(\"restoredraft\",{title:\"Restore last draft\",onclick:i,onPostRender:h}),a.addMenuItem(\"restoredraft\",{text:\"Restore last draft\",onclick:i,onPostRender:h,context:\"file\"}),a.settings.autosave_restore_when_empty!==!1&&(a.on(\"init\",function(){c()&&j()&&f()}),a.on(\"saveContent\",function(){d()})),window.onbeforeunload=tinymce._beforeUnloadHandler,this.hasDraft=c,this.storeDraft=e,this.restoreDraft=f,this.removeDraft=d,this.isEmpty=j});\n//# sourceMappingURL=plugin.min.js.map"]}